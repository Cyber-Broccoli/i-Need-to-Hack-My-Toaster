# Active Information Gathering
# DNS Enumeration

## DNS records
```Bash
kali@kali:~$ host -t txt megacorpone.com
megacorpone.com descriptive text "google-site-verification=U7B_b0HNeBtY4qYGQZNsEYXfCJ32hMNV3GtC0wWq5pA"
megacorpone.com descriptive text "Try Harder"
                                                                                                
kali@kali:~$ host -t mx megacorpone.com 
megacorpone.com mail is handled by 20 spool.mail.gandi.net.
megacorpone.com mail is handled by 10 fb.mail.gandi.net.
megacorpone.com mail is handled by 60 mail2.megacorpone.com.
megacorpone.com mail is handled by 50 mail.megacorpone.com.

```
## Forward Lookup Brute Force
```Bash
kali@kali:~/Desktop/PEN_200-PWK$ cat list.txt                        
ftp
mail
proxy
router
www
owa

                                                                                                 
kali@kali:~/Desktop/PEN_200-PWK$ for item in $(cat list.txt);do host $item.megacorpone.com;done
Host ftp.megacorpone.com not found: 3(NXDOMAIN)
mail.megacorpone.com has address 51.222.169.212
Host proxy.megacorpone.com not found: 3(NXDOMAIN)
router.megacorpone.com has address 51.222.169.214
www.megacorpone.com has address 149.56.244.87
Host owa.megacorpone.com not found: 3(NXDOMAIN)

kali@kali:~/Desktop/PEN_200-PWK$ for item in $(cat list.txt);do host $item.megacorpone.com;done | grep -v "not found"
mail.megacorpone.com has address 51.222.169.212
router.megacorpone.com has address 51.222.169.214
www.megacorpone.com has address 149.56.244.87

```
## Reverse Lookup Brute Force
```Bash
kali@kali:~$ host -t ptr megacorpone.com
megacorpone.com has no PTR record
```
> [!NOTE]
> As no PTR record has been configured for the domain we can't use reverse lookups.

## DNS Zone Transfer
A zone transfer is basically a database replication between related DNS servers in which the zone
file is copied from a master DNS server to a slave server. The zone file contains a list of all the DNS
names configured for that zone.

host -l <domain name> <dns server address>

```Bash
kali@kali:~$ host -l megacorpone.com ns1.megacorpone.com
Using domain server:
Name: ns1.megacorpone.com
Address: 51.79.37.18#53
Aliases: 

Host megacorpone.com not found: 5(REFUSED)
; Transfer failed.
                                                                                                 
kali@kali:~$ host -l megacorpone.com ns2.megacorpone.com
Using domain server:
Name: ns2.megacorpone.com
Address: 51.222.39.63#53
Aliases: 

megacorpone.com name server ns1.megacorpone.com.
megacorpone.com name server ns2.megacorpone.com.
megacorpone.com name server ns3.megacorpone.com.
admin.megacorpone.com has address 51.222.169.208
beta.megacorpone.com has address 51.222.169.209
fs1.megacorpone.com has address 51.222.169.210
intranet.megacorpone.com has address 51.222.169.211
mail.megacorpone.com has address 51.222.169.212
mail2.megacorpone.com has address 51.222.169.213
ns1.megacorpone.com has address 51.79.37.18
ns2.megacorpone.com has address 51.222.39.63
ns3.megacorpone.com has address 66.70.207.180
router.megacorpone.com has address 51.222.169.214
siem.megacorpone.com has address 51.222.169.215
snmp.megacorpone.com has address 51.222.169.216
support.megacorpone.com has address 51.222.169.218
syslog.megacorpone.com has address 51.222.169.217
test.megacorpone.com has address 51.222.169.219
vpn.megacorpone.com has address 51.222.169.220
www.megacorpone.com has address 149.56.244.87
www2.megacorpone.com has address 149.56.244.87
```
### DNSRecon
```Bash
kali@kali:~/Desktop/PEN_200-PWK$ dnsrecon -d megacorpone.com -t axfr
[*] Checking for Zone Transfer for megacorpone.com name servers
[*] Resolving SOA Record
[+]      SOA ns1.megacorpone.com 51.79.37.18
[*] Resolving NS Records
[*] NS Servers found:
[+]      NS ns1.megacorpone.com 51.79.37.18
[+]      NS ns2.megacorpone.com 51.222.39.63
[+]      NS ns3.megacorpone.com 66.70.207.180
[*] Removing any duplicate NS server IP Addresses...
[*]  
[*] Trying NS server 51.222.39.63
[+] 51.222.39.63 Has port 53 TCP Open
[+] Zone Transfer was successful!!
[*]      NS ns1.megacorpone.com 51.79.37.18
[*]      NS ns2.megacorpone.com 51.222.39.63
[*]      NS ns3.megacorpone.com 66.70.207.180
[*]      TXT Try Harder
[*]      TXT google-site-verification=U7B_b0HNeBtY4qYGQZNsEYXfCJ32hMNV3GtC0wWq5pA
[*]      MX @.megacorpone.com fb.mail.gandi.net 217.70.178.215
[*]      MX @.megacorpone.com fb.mail.gandi.net 217.70.178.217
[*]      MX @.megacorpone.com fb.mail.gandi.net 217.70.178.216
[*]      MX @.megacorpone.com fb.mail.gandi.net 2001:4b98:dc4:8::217
[*]      MX @.megacorpone.com fb.mail.gandi.net 2001:4b98:dc4:8::216
[*]      MX @.megacorpone.com fb.mail.gandi.net 2001:4b98:dc4:8::215
[*]      MX @.megacorpone.com spool.mail.gandi.net 217.70.178.1
[*]      MX @.megacorpone.com spool.mail.gandi.net 2001:4b98:e00::1
[*]      A admin.megacorpone.com 51.222.169.208
[*]      A beta.megacorpone.com 51.222.169.209
[*]      A fs1.megacorpone.com 51.222.169.210
[*]      A intranet.megacorpone.com 51.222.169.211
[*]      A mail.megacorpone.com 51.222.169.212
[*]      A mail2.megacorpone.com 51.222.169.213
[*]      A ns1.megacorpone.com 51.79.37.18
[*]      A ns2.megacorpone.com 51.222.39.63
[*]      A ns3.megacorpone.com 66.70.207.180
[*]      A router.megacorpone.com 51.222.169.214
[*]      A siem.megacorpone.com 51.222.169.215
[*]      A snmp.megacorpone.com 51.222.169.216
[*]      A support.megacorpone.com 51.222.169.218
[*]      A syslog.megacorpone.com 51.222.169.217
[*]      A test.megacorpone.com 51.222.169.219
[*]      A vpn.megacorpone.com 51.222.169.220
[*]      A www.megacorpone.com 149.56.244.87
[*]      A www2.megacorpone.com 149.56.244.87
[*]  
[*] Trying NS server 66.70.207.180
[+] 66.70.207.180 Has port 53 TCP Open
[-] Zone Transfer Failed (Zone transfer error: REFUSED)
[*]  
[*] Trying NS server 51.79.37.18
[+] 51.79.37.18 Has port 53 TCP Open
[-] Zone Transfer Failed (Zone transfer error: REFUSED)
```

```
kali@kali:~/Desktop/PEN_200-PWK$ cat list.txt  
ftp
mail
proxy
router
www
owa

                                                                                                
kali@kali:~/Desktop/PEN_200-PWK$ dnsrecon -d megacorpone.com -D list.txt -t brt
[*] Using the dictionary file: list.txt (provided by user)
[*] brt: Performing host and subdomain brute force against megacorpone.com...
[+]      A router.megacorpone.com 51.222.169.214
[+]      A www.megacorpone.com 149.56.244.87
[+]      A mail.megacorpone.com 51.222.169.212
[+] 3 Records Found
                                                
```

### DNSEnum
```Bash
kali@kali:~/Desktop/PEN_200-PWK$ dnsenum megacorpone.com
dnsenum VERSION:1.2.6

-----   megacorpone.com   -----                                                                 
                                                                                                
                                                                                                
Host's addresses:                                                                               
__________________                                                                              
                                                                                                
                                                                                                
                                                                                                
Name Servers:                                                                                   
______________                                                                                  
                                                                                                
ns3.megacorpone.com.                     5        IN    A        66.70.207.180                  
ns2.megacorpone.com.                     5        IN    A        51.222.39.63
ns1.megacorpone.com.                     5        IN    A        51.79.37.18

                                                                                                
Mail (MX) Servers:                                                                              
___________________                                                                             
                                                                                                
fb.mail.gandi.net.                       5        IN    A        217.70.178.215                 
fb.mail.gandi.net.                       5        IN    A        217.70.178.217
fb.mail.gandi.net.                       5        IN    A        217.70.178.216
mail2.megacorpone.com.                   5        IN    A        51.222.169.213
spool.mail.gandi.net.                    5        IN    A        217.70.178.1
mail.megacorpone.com.                    5        IN    A        51.222.169.212

                                                                                                
Trying Zone Transfers and getting Bind Versions:                                                
_________________________________________________                                               
                                                                                                
                                                                                                
Trying Zone Transfer for megacorpone.com on ns2.megacorpone.com ... 
megacorpone.com.                         300      IN    SOA               (
megacorpone.com.                         300      IN    TXT            "Try
megacorpone.com.                         300      IN    TXT               (
megacorpone.com.                         300      IN    MX               10
megacorpone.com.                         300      IN    MX               20
megacorpone.com.                         300      IN    MX               50
megacorpone.com.                         300      IN    MX               60
megacorpone.com.                         300      IN    NS       ns1.megacorpone.com.
megacorpone.com.                         300      IN    NS       ns2.megacorpone.com.
megacorpone.com.                         300      IN    NS       ns3.megacorpone.com.
admin.megacorpone.com.                   300      IN    A        51.222.169.208
beta.megacorpone.com.                    300      IN    A        51.222.169.209
fs1.megacorpone.com.                     300      IN    A        51.222.169.210
intranet.megacorpone.com.                300      IN    A        51.222.169.211
mail.megacorpone.com.                    300      IN    A        51.222.169.212
mail2.megacorpone.com.                   300      IN    A        51.222.169.213
ns1.megacorpone.com.                     300      IN    A        51.79.37.18
ns2.megacorpone.com.                     300      IN    A        51.222.39.63
ns3.megacorpone.com.                     300      IN    A        66.70.207.180
router.megacorpone.com.                  300      IN    A        51.222.169.214
siem.megacorpone.com.                    300      IN    A        51.222.169.215
snmp.megacorpone.com.                    300      IN    A        51.222.169.216
support.megacorpone.com.                 300      IN    A        51.222.169.218
syslog.megacorpone.com.                  300      IN    A        51.222.169.217
test.megacorpone.com.                    300      IN    A        51.222.169.219
vpn.megacorpone.com.                     300      IN    A        51.222.169.220
www.megacorpone.com.                     300      IN    A        149.56.244.87
www2.megacorpone.com.                    300      IN    A        149.56.244.87

Trying Zone Transfer for megacorpone.com on ns1.megacorpone.com ... 
AXFR record query failed: REFUSED

Trying Zone Transfer for megacorpone.com on ns3.megacorpone.com ... 
AXFR record query failed: REFUSED

                                                                                                
Brute forcing with /usr/share/dnsenum/dns.txt:                                                  
_______________________________________________                                                 
                                                                                                
^C                                                                                              
                                                                                                
kali@kali:~/Desktop/PEN_200-PWK$ dnsenum zonetransfer.me
dnsenum VERSION:1.2.6

-----   zonetransfer.me   -----                                                                 
                                                                                                
                                                                                                
Host's addresses:                                                                               
__________________                                                                              
                                                                                                
zonetransfer.me.                         5        IN    A        5.196.105.14                   

                                                                                                
Name Servers:                                                                                   
______________                                                                                  
                                                                                                
nsztm1.digi.ninja.                       5        IN    A        81.4.108.41                    
nsztm2.digi.ninja.                       5        IN    A        34.225.33.2

                                                                                                
Mail (MX) Servers:                                                                              
___________________                                                                             
                                                                                                
ASPMX.L.GOOGLE.COM.                      5        IN    A        74.125.133.27                  
ALT2.ASPMX.L.GOOGLE.COM.                 5        IN    A        142.251.9.26
ALT1.ASPMX.L.GOOGLE.COM.                 5        IN    A        142.250.153.26
ASPMX4.GOOGLEMAIL.COM.                   5        IN    A        142.250.150.27
ASPMX2.GOOGLEMAIL.COM.                   5        IN    A        142.250.153.27
ASPMX3.GOOGLEMAIL.COM.                   5        IN    A        142.251.9.27
ASPMX5.GOOGLEMAIL.COM.                   5        IN    A        74.125.200.27

                                                                                                
Trying Zone Transfers and getting Bind Versions:                                                
_________________________________________________                                               
                                                                                                
                                                                                                
Trying Zone Transfer for zonetransfer.me on nsztm2.digi.ninja ... 
zonetransfer.me.                         7200     IN    SOA               (
zonetransfer.me.                         300      IN    HINFO        "Casio
zonetransfer.me.                         301      IN    TXT               (
zonetransfer.me.                         7200     IN    MX                0
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    A        5.196.105.14
zonetransfer.me.                         7200     IN    NS       nsztm1.digi.ninja.
zonetransfer.me.                         7200     IN    NS       nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_sip._tcp.zonetransfer.me.               14000    IN    SRV               0
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200     IN    PTR      www.zonetransfer.me.
asfdbauthdns.zonetransfer.me.            7900     IN    AFSDB             1
asfdbbox.zonetransfer.me.                7200     IN    A         127.0.0.1
asfdbvolume.zonetransfer.me.             7800     IN    AFSDB             1
canberra-office.zonetransfer.me.         7200     IN    A        202.14.81.230
cmdexec.zonetransfer.me.                 300      IN    TXT              ";
contact.zonetransfer.me.                 2592000  IN    TXT               (
dc-office.zonetransfer.me.               7200     IN    A        143.228.181.132
deadbeef.zonetransfer.me.                7201     IN    AAAA     dead:beaf::
dr.zonetransfer.me.                      300      IN    LOC              53
DZC.zonetransfer.me.                     7200     IN    TXT         AbCdEfG
email.zonetransfer.me.                   2222     IN    NAPTR             (
email.zonetransfer.me.                   7200     IN    A        74.125.206.26
Hello.zonetransfer.me.                   7200     IN    TXT             "Hi
home.zonetransfer.me.                    7200     IN    A         127.0.0.1
Info.zonetransfer.me.                    7200     IN    TXT               (
internal.zonetransfer.me.                300      IN    NS       intns1.zonetransfer.me.
internal.zonetransfer.me.                300      IN    NS       intns2.zonetransfer.me.
intns1.zonetransfer.me.                  300      IN    A        81.4.108.41
intns2.zonetransfer.me.                  300      IN    A        52.91.28.78
office.zonetransfer.me.                  7200     IN    A        4.23.39.254
ipv6actnow.org.zonetransfer.me.          7200     IN    AAAA     2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.                     7200     IN    A        207.46.197.32
robinwood.zonetransfer.me.               302      IN    TXT          "Robin
rp.zonetransfer.me.                      321      IN    RP                (
sip.zonetransfer.me.                     3333     IN    NAPTR             (
sqli.zonetransfer.me.                    300      IN    TXT              "'
sshock.zonetransfer.me.                  7200     IN    TXT             "()
staging.zonetransfer.me.                 7200     IN    CNAME    www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301      IN    A         127.0.0.1
testing.zonetransfer.me.                 301      IN    CNAME    www.zonetransfer.me.
vpn.zonetransfer.me.                     4000     IN    A        174.36.59.154
www.zonetransfer.me.                     7200     IN    A        5.196.105.14
xss.zonetransfer.me.                     300      IN    TXT      "'><script>alert('Boo')</script>"

Trying Zone Transfer for zonetransfer.me on nsztm1.digi.ninja ... 
zonetransfer.me.                         7200     IN    SOA               (
zonetransfer.me.                         300      IN    HINFO        "Casio
zonetransfer.me.                         301      IN    TXT               (
zonetransfer.me.                         7200     IN    MX                0
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               10
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    MX               20
zonetransfer.me.                         7200     IN    A        5.196.105.14
zonetransfer.me.                         7200     IN    NS       nsztm1.digi.ninja.
zonetransfer.me.                         7200     IN    NS       nsztm2.digi.ninja.
_acme-challenge.zonetransfer.me.         301      IN    TXT               (
_sip._tcp.zonetransfer.me.               14000    IN    SRV               0
14.105.196.5.IN-ADDR.ARPA.zonetransfer.me. 7200     IN    PTR      www.zonetransfer.me.
asfdbauthdns.zonetransfer.me.            7900     IN    AFSDB             1
asfdbbox.zonetransfer.me.                7200     IN    A         127.0.0.1
asfdbvolume.zonetransfer.me.             7800     IN    AFSDB             1
canberra-office.zonetransfer.me.         7200     IN    A        202.14.81.230
cmdexec.zonetransfer.me.                 300      IN    TXT              ";
contact.zonetransfer.me.                 2592000  IN    TXT               (
dc-office.zonetransfer.me.               7200     IN    A        143.228.181.132
deadbeef.zonetransfer.me.                7201     IN    AAAA     dead:beaf::
dr.zonetransfer.me.                      300      IN    LOC              53
DZC.zonetransfer.me.                     7200     IN    TXT         AbCdEfG
email.zonetransfer.me.                   2222     IN    NAPTR             (
email.zonetransfer.me.                   7200     IN    A        74.125.206.26
Hello.zonetransfer.me.                   7200     IN    TXT             "Hi
home.zonetransfer.me.                    7200     IN    A         127.0.0.1
Info.zonetransfer.me.                    7200     IN    TXT               (
internal.zonetransfer.me.                300      IN    NS       intns1.zonetransfer.me.
internal.zonetransfer.me.                300      IN    NS       intns2.zonetransfer.me.
intns1.zonetransfer.me.                  300      IN    A        81.4.108.41
intns2.zonetransfer.me.                  300      IN    A        167.88.42.94
office.zonetransfer.me.                  7200     IN    A        4.23.39.254
ipv6actnow.org.zonetransfer.me.          7200     IN    AAAA     2001:67c:2e8:11::c100:1332
owa.zonetransfer.me.                     7200     IN    A        207.46.197.32
robinwood.zonetransfer.me.               302      IN    TXT          "Robin
rp.zonetransfer.me.                      321      IN    RP                (
sip.zonetransfer.me.                     3333     IN    NAPTR             (
sqli.zonetransfer.me.                    300      IN    TXT              "'
sshock.zonetransfer.me.                  7200     IN    TXT             "()
staging.zonetransfer.me.                 7200     IN    CNAME    www.sydneyoperahouse.com.
alltcpportsopen.firewall.test.zonetransfer.me. 301      IN    A         127.0.0.1
testing.zonetransfer.me.                 301      IN    CNAME    www.zonetransfer.me.
vpn.zonetransfer.me.                     4000     IN    A        174.36.59.154
www.zonetransfer.me.                     7200     IN    A        5.196.105.14
xss.zonetransfer.me.                     300      IN    TXT      "'><script>alert('Boo')</script>"

                                                                                                
Brute forcing with /usr/share/dnsenum/dns.txt:                                                  
_______________________________________________   
```
